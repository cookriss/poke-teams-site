<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokéTeams - Comparte y Descubre Equipos Pokémon</title>
    <style>
        :root {
            --primary: #ff5350;
            --primary-dark: #d13330;
            --secondary: #3b4cca;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #30c58b;
            --danger: #dc3545; /* Color para errores */
        }

        /* ... (tus estilos CSS existentes, asegúrate de que son responsivos y se ven bien) ... */
        /* Estilos adicionales para formularios y mensajes */
        body {
            background-color: #f4f4f4;
            color: var(--dark);
            line-height: 1.6;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .logo span {
            color: var(--secondary);
        }

        .nav-links {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
        }

        .nav-links li {
            margin-left: 1rem; 
            margin-bottom: 0.5rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s, background-color 0.3s;
            padding: 0.3rem 0.5rem;
            border-radius: 5px;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--primary);
            background-color: white;
        }
        /* Estilos para la sección de autenticación */
        .auth-section {
            background-color: white;
            padding: 2rem;
            margin: 2rem auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-width: 500px;
        }

        .auth-section h2 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="password"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="email"]:focus,
        .form-group input[type="password"]:focus {
            border-color: var(--secondary);
            outline: none;
        }

        .auth-button {
            background-color: var(--secondary);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
            display: block;
            width: 100%;
            margin-top: 1rem;
        }

        .auth-button:hover {
            background-color: #2a3ba9; /* Un poco más oscuro que var(--secondary) */
        }
        
        .auth-toggle-link {
            display: block;
            text-align: center;
            margin-top: 1.5rem;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        .auth-toggle-link:hover {
            text-decoration: underline;
        }

        /* Mensajes de feedback */
        .feedback-message {
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: 5px;
            text-align: center;
        }

        .feedback-message.success {
            background-color: var(--success);
            color: white;
        }

        .feedback-message.error {
            background-color: var(--danger);
            color: white;
        }
        
        /* Ocultar formularios por defecto */
        #login-section, #register-section {
            display: none; /* Se mostrarán con JS */
        }
        #user-greeting {
            display: none; /* Se mostrará cuando el usuario inicie sesión */
            color: white;
            font-weight: 500;
            margin-left: 1rem;
        }

        /* ... (resto de tus estilos CSS que tenías en el HTML original) ... */
        .search-bar {
            background-color: white;
            border-radius: 25px;
            padding: 0.6rem 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-bar input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 0.9rem;
            padding-right: 1rem;
        }

        .search-bar button {
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 0.4rem 1rem;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .search-bar button:hover {
            background-color: #2a3ba9;
        }
        main.container {
            padding-top: 1rem;
        }
        .featured-section {
            margin: 2rem 0;
        }
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 0.5rem;
            display: inline-block;
        }
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .team-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
        }
        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        .team-header {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .team-title {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .team-format {
            background-color: var(--secondary);
            padding: 0.3rem 0.6rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .team-pokemon {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            padding: 1rem;
            flex-grow: 1;
        }
        .pokemon-icon {
            text-align: center;
        }
        .pokemon-icon img {
            width: 100%;
            max-width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 50%;
            background-color: #f0f0f0;
            border: 2px solid #ddd;
            margin-bottom: 0.3rem;
        }
        .pokemon-icon img[alt="Placeholder"] {
            object-fit: scale-down;
        }
        .pokemon-name {
            font-size: 0.85rem;
            margin-top: 0.3rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-weight: 500;
        }
        .team-footer {
            padding: 1rem;
            background-color: #f8f8f8;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            align-items: stretch;
            border-top: 1px solid #eee;
            font-size: 0.9rem;
        }
        .team-info-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        .team-stats {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .stat {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        .team-creator {
            font-weight: 500;
            color: var(--secondary);
            text-align: right;
        }
        .pokepaste-button {
            background-color: var(--success);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            text-align: center;
            display: block;
            margin-top: 0.5rem;
        }
        .pokepaste-button:hover {
            background-color: #28a745;
        }
        .cta-section {
            text-align: center;
            margin: 3rem 0;
            padding: 2.5rem 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .cta-title {
            font-size: 2.2rem;
            margin-bottom: 1rem;
        }
        .cta-description {
            max-width: 600px;
            margin: 0 auto 1.5rem;
            line-height: 1.7;
            font-size: 1.1rem;
        }
        .cta-button { /* Estilo del botón de Crear Equipo */
            background-color: white;
            color: var(--primary);
            text-decoration: none;
            padding: 0.9rem 2.2rem;
            border-radius: 25px;
            font-weight: bold;
            display: inline-block;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .cta-button:hover {
            background-color: transparent;
            color: white;
            border-color: white;
            transform: translateY(-3px);
        }
        .categories-section {
            margin: 2rem 0;
        }
        .category-list {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 1rem 0;
            justify-content: center;
        }
        .category-item {
            background-color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid #ddd;
        }
        .category-item:hover,
        .category-item.active {
            background-color: var(--secondary);
            color: white;
            border-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 0 2rem;
            margin-top: 3rem;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        .footer-column {
            flex: 1;
            min-width: 220px;
        }
        .footer-column h3 {
            margin-bottom: 1.2rem;
            font-size: 1.3rem;
            color: var(--primary);
        }
        .footer-column p {
            color: #ccc;
            line-height: 1.7;
        }
        .footer-links {
            list-style: none;
        }
        .footer-links li {
            margin-bottom: 0.8rem;
        }
        .footer-links a {
            color: #aaa;
            text-decoration: none;
            transition: color 0.3s, padding-left 0.3s;
        }
        .footer-links a:hover {
            color: white;
            padding-left: 5px;
        }
        .footer-bottom {
            margin-top: 2rem;
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid #555;
            color: #aaa;
            font-size: 0.9rem;
        }
        /* Media Queries para responsividad */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                align-items: flex-start;
            }
            .nav-links {
                margin-top: 1rem;
                width: 100%;
                justify-content: space-around;
            }
            .nav-links li {
                margin-left: 0;
            }
            .search-bar {
                max-width: 100%;
            }
            .team-footer {
                align-items: center;
            }
            .team-info-actions {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
            .team-creator {
                text-align: left;
            }
        }

    </style>
</head>

<body>
    <header>
        <div class="container">
            <div class="navbar">
                <div class="logo">Poké<span>Teams</span></div>
                <ul class="nav-links">
                    <li><a href="#" id="home-link" class="active">Inicio</a></li>
                    <li><a href="#" id="popular-link">Populares</a></li>
                    <li id="login-nav-link"><a href="#">Iniciar Sesión</a></li>
                    <li id="register-nav-link"><a href="#">Registrarse</a></li>
                    <li id="logout-nav-link" style="display:none;"><a href="#">Cerrar Sesión</a></li>
                    <li id="user-greeting"></li> </ul>
            </div>
             <div class="search-bar">
                <input type="text" placeholder="Buscar equipos, Pokémon o usuarios...">
                <button>Buscar</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section id="login-section" class="auth-section">
            <h2>Iniciar Sesión</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Contraseña</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <button type="submit" class="auth-button">Entrar</button>
            </form>
            <div id="login-feedback" class="feedback-message" style="display:none;"></div>
            <a href="#" id="show-register-link" class="auth-toggle-link">¿No tienes cuenta? Regístrate</a>
        </section>

        <section id="register-section" class="auth-section">
            <h2>Crear Cuenta</h2>
            <form id="register-form">
                <div class="form-group">
                    <label for="register-username">Nombre de Usuario</label>
                    <input type="text" id="register-username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="register-password">Contraseña (mín. 6 caracteres)</label>
                    <input type="password" id="register-password" name="password" required minlength="6">
                </div>
                <button type="submit" class="auth-button">Registrarse</button>
            </form>
            <div id="register-feedback" class="feedback-message" style="display:none;"></div>
            <a href="#" id="show-login-link" class="auth-toggle-link">¿Ya tienes cuenta? Inicia Sesión</a>
        </section>

        <div id="main-content">
            <section class="featured-section">
                <h2 class="section-title">Equipos Destacados</h2>
                <div class="team-grid">
                    <div class="team-card" data-team-id="equipo1">
                        <div class="team-header">
                            <div class="team-title">Campeones de la Liga</div>
                            <div class="team-format">VGC 2025</div>
                        </div>
                        <div class="team-pokemon">
                            <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/E9544E/white?text=Pika&font=roboto" alt="Pikachu">
                                <div class="pokemon-name">Pikachu</div>
                            </div>
                             <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/F7A04A/white?text=Char&font=roboto" alt="Charizard">
                                <div class="pokemon-name">Charizard</div>
                            </div>
                            <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/6A93D8/white?text=Blas&font=roboto" alt="Blastoise">
                                <div class="pokemon-name">Blastoise</div>
                            </div>
                            <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/7AC74C/white?text=Venu&font=roboto" alt="Venusaur">
                                <div class="pokemon-name">Venusaur</div>
                            </div>
                            <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/A8A77A/white?text=Snor&font=roboto" alt="Snorlax">
                                <div class="pokemon-name">Snorlax</div>
                            </div>
                            <div class="pokemon-icon">
                                <img src="https://placehold.co/70x70/FFC107/white?text=Drag&font=roboto" alt="Dragonite">
                                <div class="pokemon-name">Dragonite</div>
                            </div>
                        </div>
                        <div class="team-footer">
                            <div class="team-info-actions">
                                <div class="team-stats">
                                    <div class="stat">👍 245</div> <div class="stat">💬 32</div> <div class="stat">💾 189</div>
                                </div>
                                <div class="team-creator">Por: MaestroPoké</div>
                            </div>
                            <button class="pokepaste-button">Copiar a Pokepaste</button>
                        </div>
                    </div>
                    </div>
            </section>
            <section class="cta-section">
                <h2 class="cta-title">Crea y Comparte Tu Propio Equipo</h2>
                <p class="cta-description">¿Tienes una combinación ganadora? Compártela con la comunidad, recibe comentarios y ayuda a otros entrenadores a mejorar.</p>
                <a href="#" class="cta-button">Crear Equipo</a>
            </section>
            <section class="categories-section">
                <h2 class="section-title">Explorar por Formato</h2>
                <div class="category-list">
                    <div class="category-item active">Todos</div>
                    <div class="category-item">VGC 2025</div>
                    <div class="category-item">OU Singles</div>
                    <div class="category-item">UU Singles</div>
                    <div class="category-item">Doubles</div>
                    <div class="category-item">Monotype</div>
                    <div class="category-item">Battle Stadium</div>
                    <div class="category-item">Little Cup</div>
                </div>
            </section>
             <section class="featured-section">
                <h2 class="section-title">Equipos Populares</h2>
                <div class="team-grid">
                    </div>
            </section>
        </div>

    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Poké<span>Teams</span></h3>
                    <p>La comunidad definitiva para compartir y descubrir equipos Pokémon competitivos.</p>
                </div>
                <div class="footer-column">
                    <h3>Enlaces</h3>
                    <ul class="footer-links">
                        <li><a href="#">Inicio</a></li>
                        <li><a href="#">Equipos Populares</a></li>
                        <li><a href="#">Crear Equipo</a></li>
                        <li><a href="#">Guías</a></li>
                        <li><a href="#">Foro</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Recursos</h3>
                    <ul class="footer-links">
                        <li><a href="#">Base de Datos Pokémon</a></li>
                        <li><a href="#">Calculadora de Estadísticas</a></li>
                        <li><a href="#">Movimientos</a></li>
                        <li><a href="#">Objetos</a></li>
                        <li><a href="#">Habilidades</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Información</h3>
                    <ul class="footer-links">
                        <li><a href="#">Acerca de</a></li>
                        <li><a href="#">Términos de Uso</a></li>
                        <li><a href="#">Política de Privacidad</a></li>
                        <li><a href="#">Contacto</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 PokéTeams. Pokémon y los nombres de los personajes de Pokémon son marcas comerciales de Nintendo.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ----- URLs y Selectores -----
            const WORKER_BASE_URL = 'https://poke-teams-auth.srcookriss.workers.dev'; // URL de tu Worker actualizada
            const REGISTER_URL = `${WORKER_BASE_URL}/api/register`;
            const LOGIN_URL = `${WORKER_BASE_URL}/api/login`;

            // Secciones y Formularios
            const loginSection = document.getElementById('login-section');
            const registerSection = document.getElementById('register-section');
            const mainContent = document.getElementById('main-content');

            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');

            // Mensajes de feedback
            const loginFeedback = document.getElementById('login-feedback');
            const registerFeedback = document.getElementById('register-feedback');

            // Enlaces de navegación
            const loginNav = document.getElementById('login-nav-link');
            const registerNav = document.getElementById('register-nav-link');
            const logoutNav = document.getElementById('logout-nav-link');
            const userGreeting = document.getElementById('user-greeting');
            
            // Enlaces para cambiar entre formularios
            const showRegisterLink = document.getElementById('show-register-link');
            const showLoginLink = document.getElementById('show-login-link');
            const homeLink = document.getElementById('home-link');


            // ----- Funciones de UI -----
            function showFeedback(element, message, isError = false) {
                if (!element) return;
                element.textContent = message;
                element.className = 'feedback-message ' + (isError ? 'error' : 'success');
                element.style.display = 'block';
                setTimeout(() => { element.style.display = 'none'; }, 5000); // Ocultar después de 5 segundos
            }

            function showLoginForm() {
                if (loginSection) loginSection.style.display = 'block';
                if (registerSection) registerSection.style.display = 'none';
                if (mainContent) mainContent.style.display = 'none'; // Ocultar contenido principal
            }

            function showRegisterForm() {
                if (loginSection) loginSection.style.display = 'none';
                if (registerSection) registerSection.style.display = 'block';
                if (mainContent) mainContent.style.display = 'none'; // Ocultar contenido principal
            }
            
            function showMainContent() {
                if (loginSection) loginSection.style.display = 'none';
                if (registerSection) registerSection.style.display = 'none';
                if (mainContent) mainContent.style.display = 'block';
            }

            function updateNavForLoggedInUser(username) {
                if (loginNav) loginNav.style.display = 'none';
                if (registerNav) registerNav.style.display = 'none';
                if (logoutNav) logoutNav.style.display = 'block'; // Mostrar enlace de logout
                if (userGreeting) {
                    userGreeting.textContent = `Hola, ${username}`;
                    userGreeting.style.display = 'block'; // Mostrar saludo
                }
                showMainContent(); // Mostrar contenido principal después del login
            }

            function updateNavForLoggedOutUser() {
                if (loginNav) loginNav.style.display = 'block'; // Mostrar enlace de login
                if (registerNav) registerNav.style.display = 'block'; // Mostrar enlace de registro
                if (logoutNav) logoutNav.style.display = 'none'; // Ocultar enlace de logout
                if (userGreeting) userGreeting.style.display = 'none'; // Ocultar saludo
                showMainContent(); // Por defecto mostrar contenido principal
            }


            // ----- Lógica de Autenticación -----

            // Registro
            if (registerForm) {
                registerForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    // Validación simple para la URL del worker (ya está configurada arriba)
                    if (!WORKER_BASE_URL || WORKER_BASE_URL === 'URL_DE_TU_WORKER_AQUI') {
                         showFeedback(registerFeedback, 'Error: La URL del Worker no está configurada correctamente.', true);
                         console.error("WORKER_BASE_URL no está configurada.");
                         return;
                    }

                    const formData = new FormData(registerForm);
                    const data = Object.fromEntries(formData.entries());

                    try {
                        const response = await fetch(REGISTER_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data),
                        });
                        const result = await response.json();

                        if (response.ok) {
                            showFeedback(registerFeedback, `¡Registro exitoso! ${result.message}. Ahora puedes iniciar sesión.`, false);
                            registerForm.reset();
                            setTimeout(showLoginForm, 2000); 
                        } else {
                            showFeedback(registerFeedback, `Error en registro: ${result.error || response.statusText}`, true);
                        }
                    } catch (error) {
                        console.error('Error de red en registro:', error);
                        showFeedback(registerFeedback, 'Error de conexión al intentar registrar. Intenta de nuevo.', true);
                    }
                });
            }

            // Login
            if (loginForm) {
                loginForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                     if (!WORKER_BASE_URL || WORKER_BASE_URL === 'URL_DE_TU_WORKER_AQUI') {
                        showFeedback(loginFeedback, 'Error: La URL del Worker no está configurada correctamente.', true);
                        console.error("WORKER_BASE_URL no está configurada.");
                        return;
                    }

                    const formData = new FormData(loginForm);
                    const data = Object.fromEntries(formData.entries());

                    try {
                        const response = await fetch(LOGIN_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data),
                        });
                        const result = await response.json();

                        if (response.ok) {
                            showFeedback(loginFeedback, `¡Inicio de sesión exitoso! Bienvenido, ${result.user.username}.`, false);
                            loginForm.reset();
                            localStorage.setItem('userData', JSON.stringify(result.user)); 
                            updateNavForLoggedInUser(result.user.username);
                        } else {
                            showFeedback(loginFeedback, `Error en login: ${result.error || response.statusText}`, true);
                        }
                    } catch (error) {
                        console.error('Error de red en login:', error);
                        showFeedback(loginFeedback, 'Error de conexión al intentar iniciar sesión. Intenta de nuevo.', true);
                    }
                });
            }
            
            // Logout
            if (logoutNav) {
                logoutNav.addEventListener('click', (e) => {
                    e.preventDefault();
                    localStorage.removeItem('userData'); 
                    updateNavForLoggedOutUser();
                    showMainContent(); 
                });
            }

            // ----- Manejo de Navegación y Estado Inicial -----
            if (loginNav) loginNav.addEventListener('click', (e) => { e.preventDefault(); showLoginForm(); });
            if (registerNav) registerNav.addEventListener('click', (e) => { e.preventDefault(); showRegisterForm(); });
            if (showLoginLink) showLoginLink.addEventListener('click', (e) => { e.preventDefault(); showLoginForm(); });
            if (showRegisterLink) showRegisterLink.addEventListener('click', (e) => { e.preventDefault(); showRegisterForm(); });
            if (homeLink) homeLink.addEventListener('click', (e) => { e.preventDefault(); showMainContent(); });

            // Comprobar si hay un usuario logueado al cargar la página
            const storedUser = localStorage.getItem('userData');
            if (storedUser) {
                try {
                    const userData = JSON.parse(storedUser);
                    updateNavForLoggedInUser(userData.username);
                } catch (e) {
                    console.error("Error al parsear userData de localStorage", e);
                    localStorage.removeItem('userData'); 
                    updateNavForLoggedOutUser();
                }
            } else {
                updateNavForLoggedOutUser();
            }
            
            // Lógica para tus botones de Pokepaste (integración básica)
            const pokepasteButtons = document.querySelectorAll('.pokepaste-button');
            pokepasteButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    // Aquí iría tu lógica específica para obtener los datos del equipo de la tarjeta
                    // y generar el string de Pokepaste.
                    // Por ahora, solo un console.log y un alert de ejemplo.
                    const teamCard = event.target.closest('.team-card');
                    const teamTitle = teamCard ? teamCard.querySelector('.team-title').textContent : "Equipo Desconocido";
                    console.log(`Botón Pokepaste clickeado para: ${teamTitle}`);
                    alert(`Funcionalidad "Copiar a Pokepaste" para "${teamTitle}" aún por implementar completamente con datos dinámicos del equipo.`);
                    // Ejemplo: const teamId = teamCard.dataset.teamId;
                    // const teamDetails = teamsData[teamId]; // Necesitarías `teamsData` definido
                    // if (teamDetails) { const pokepasteText = generatePokepasteString(teamDetails); /* ... copiar ... */ }
                });
            });

        });
    </script>
</body>
</html>
